<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Inform 7 - 19.8. Replacements</title>
</head>
<body>
<div style="line-height: 18px;">

<!-- SEARCH TITLE "Northstar" -->
<!-- SEARCH SECTION "Ex 412" -->
<!-- SEARCH SORT "Ex 019-008-412" -->
<font><table><tr width="100%"><td width=80 valign="top"><a href=doc346.html border=0><img border=0 src=images/Back.png border=0></a><a href=index.html border=0><img border=0 src=images/Home.png border=0></a><a href=doc348.html border=0><img border=0 src=images/Forward.png border=0></a></td><td valign="top"><b>19.8. Replacements</b></td></tr></table><p>
<p>
<p>Suppose V is an indexed text which varies - perhaps a property of something, or a variable defined everywhere, or a temporary &quot;let&quot;-named value. How do we change its contents? The easiest way is simply to assign text to it. Thus:
<p>
<blockquote><font color="#000080">let V be &quot;It is now [the time of the day in words].&quot;
</font></blockquote><p>
<p>
<p>And, for instance,
<p>
<blockquote><font color="#000080">let V be &quot;[V]!&quot;
</font></blockquote><p>
<p>
<p>adds an exclamation mark at the end of V.
<p>
<p>Otherwise, it is more useful (also a little faster) to modify V by changing its characters, words and so on. Thus:
<p>
<p><p style='padding: 0.75em; border: 1px dashed #2f6fab; color: black; background-color: #e9e9e9; line-height: 1.5em; '><b>replace character number </b>(number)<b> in </b>(indexed text)<b> with </b>(indexed text)<b></b><table CELLPADDING=0 CELLSPACING=0 width='100%'><tr><td halign='left' valign='center' CELLPADDING=0 CELLSPACING=0><font>
<!-- definition of ph_replacechar -->

<p>This phrase acts on the named text by placing the given text in place of the Nth character, counting from 1. Example:
<p>
<blockquote><font color="#000080">let V be an indexed text;
<br>let V be &quot;mope&quot;;
<br>replace character number 3 in V with &quot;lecul&quot;;
<br>say V;
</font></blockquote><p>
<p>
<p>says &quot;molecule&quot;.
<p>
<!-- end definition -->
</table>
<p>
<p><p style='padding: 0.75em; border: 1px dashed #2f6fab; color: black; background-color: #e9e9e9; line-height: 1.5em; '><b>replace word number </b>(number)<b> in </b>(indexed text)<b> with </b>(indexed text)<b></b><table CELLPADDING=0 CELLSPACING=0 width='100%'><tr><td halign='left' valign='center' CELLPADDING=0 CELLSPACING=0><font>
<!-- definition of ph_replaceword -->

<p>This phrase acts on the named text by placing the given text in place of the Nth word, counting from 1, and dividing words at spacing or punctuation. Example:
<p>
<blockquote><font color="#000080">let V be an indexed text;
<br>let V be &quot;Does the well run dry?&quot;;
<br>replace word number 3 in V with &quot;jogger&quot;;
<br>say V;
</font></blockquote><p>
<p>
<p>says &quot;Does the jogger run dry?&quot;.
<p>
<!-- end definition -->
</table>
<p>
<p><p style='padding: 0.75em; border: 1px dashed #2f6fab; color: black; background-color: #e9e9e9; line-height: 1.5em; '><b>replace punctuated word number </b>(number)<b> in </b>(indexed text)<b> with </b>(indexed text)<b></b><table CELLPADDING=0 CELLSPACING=0 width='100%'><tr><td halign='left' valign='center' CELLPADDING=0 CELLSPACING=0><font>
<!-- definition of ph_replacepword -->

<p>This phrase acts on the named text by placing the given text in place of the Nth word, counting from 1, and dividing words at spacing, counting punctuation runs as words in their own right. Example:
<p>
<blockquote><font color="#000080">let V be an indexed text;
<br>let V be &quot;Frankly, yes, I agree.&quot;;
<br>replace punctuated word number 2 in V with &quot;:&quot;;
<br>say V;
</font></blockquote><p>
<p>
<p>says &quot;Frankly: yes, I agree.&quot;.
<p>
<!-- end definition -->
</table>
<p>
<p><p style='padding: 0.75em; border: 1px dashed #2f6fab; color: black; background-color: #e9e9e9; line-height: 1.5em; '><b>replace unpunctuated word number </b>(number)<b> in </b>(indexed text)<b> with </b>(indexed text)<b></b><table CELLPADDING=0 CELLSPACING=0 width='100%'><tr><td halign='left' valign='center' CELLPADDING=0 CELLSPACING=0><font>
<!-- definition of ph_replaceupword -->

<p>This phrase acts on the named text by placing the given text in place of the Nth word, counting from 1, and dividing words at spacing, counting punctuation as part of a word just as if it were lettering. Example:
<p>
<blockquote><font color="#000080">let V be an indexed text;
<br>let V be &quot;Frankly, yes, I agree.&quot;;
<br>replace unpunctuated word number 2 in V with &quot;of course&quot;;
<br>say V;
</font></blockquote><p>
<p>
<p>says &quot;Frankly, of course I agree.&quot;.
<p>
<!-- end definition -->
</table>
<p>
<p><p style='padding: 0.75em; border: 1px dashed #2f6fab; color: black; background-color: #e9e9e9; line-height: 1.5em; '><b>replace line number </b>(number)<b> in </b>(indexed text)<b> with </b>(indexed text)<b></b><table CELLPADDING=0 CELLSPACING=0 width='100%'><tr><td halign='left' valign='center' CELLPADDING=0 CELLSPACING=0><font>
<!-- definition of ph_replaceline -->

<p>This phrase acts on the named text by placing the given text in place of the Nth line, counting from 1. Lines are divided by paragraph or line breaks.
<p>
<!-- end definition -->
</table>
<p>
<p><p style='padding: 0.75em; border: 1px dashed #2f6fab; color: black; background-color: #e9e9e9; line-height: 1.5em; '><b>replace paragraph number </b>(number)<b> in </b>(indexed text)<b> with </b>(indexed text)<b></b><table CELLPADDING=0 CELLSPACING=0 width='100%'><tr><td halign='left' valign='center' CELLPADDING=0 CELLSPACING=0><font>
<!-- definition of ph_replacepara -->

<p>This phrase acts on the named text by placing the given text in place of the Nth paragraph, counting from 1.
<p>
<!-- end definition -->
</table>
<p>
<p>Last, but not least, we can replace text wherever it occurs:
<p>
<p><p style='padding: 0.75em; border: 1px dashed #2f6fab; color: black; background-color: #e9e9e9; line-height: 1.5em; '><b>replace the text </b>(indexed text)<b> in </b>(indexed text)<b> with </b>(indexed text)<b></b><table CELLPADDING=0 CELLSPACING=0 width='100%'><tr><td halign='left' valign='center' CELLPADDING=0 CELLSPACING=0><font>
<!-- definition of ph_replace -->

<p>This phrase acts on the named text by searching and replacing, as many non-overlapping times as possible. Example:
<p>
<blockquote><font color="#000080">replace the text &quot;a&quot; in V with &quot;z&quot;
</font></blockquote><p>
<p>
<p>changes every lower-case &quot;a&quot; to &quot;z&quot;: the same thing done with the &quot;case insensitively&quot; option would change each &quot;a&quot; or &quot;A&quot; to &quot;z&quot;.
<p>
<!-- end definition -->
</table>
<p>
<p>All very well for letters, but it can be unfortunate to try
<p>
<blockquote><font color="#000080">replace the text &quot;Bob&quot; in V with &quot;Robert&quot;
</font></blockquote><p>
<p>
<p>if V happens to contain, say &quot;The Olympic Bobsleigh Team&quot;: it would become &quot;The Olympic Robertsleigh Team&quot;. What we want, of course, is for Bob to become Robert only when it's a whole word. We can get that with:
<p>
<p><p style='padding: 0.75em; border: 1px dashed #2f6fab; color: black; background-color: #e9e9e9; line-height: 1.5em; '><b>replace the word </b>(indexed text)<b> in </b>(indexed text)<b> with </b>(indexed text)<b></b><table CELLPADDING=0 CELLSPACING=0 width='100%'><tr><td halign='left' valign='center' CELLPADDING=0 CELLSPACING=0><font>
<!-- definition of ph_replacewordin -->

<p>This phrase acts on the named text by searching and replacing, as many non-overlapping times as possible, where the search text must occur as a whole word. Example:
<p>
<blockquote><font color="#000080">replace the word &quot;Bob&quot; in V with &quot;Robert&quot;
</font></blockquote><p>
<p>
<p>changes &quot;Bob got on the Bobsleigh&quot; to &quot;Robert got on the Bobsleigh&quot;.
<p>
<!-- end definition -->
</table>
<p>
<p><p style='padding: 0.75em; border: 1px dashed #2f6fab; color: black; background-color: #e9e9e9; line-height: 1.5em; '><b>replace the punctuated word </b>(indexed text)<b> in </b>(indexed text)<b> with </b>(indexed text)<b></b><table CELLPADDING=0 CELLSPACING=0 width='100%'><tr><td halign='left' valign='center' CELLPADDING=0 CELLSPACING=0><font>
<!-- definition of ph_replacepwordin -->

<p>This phrase acts on the named text by searching and replacing, as many non-overlapping times as possible, where the search text must occur as a whole word or run of punctuation.
<p>
<!-- end definition -->
</table>
<p>
<p>But these are all just special cases of the grand-daddy of all replacement phrases:
<p>
<p><p style='padding: 0.75em; border: 1px dashed #2f6fab; color: black; background-color: #e9e9e9; line-height: 1.5em; '><b>replace the regular expression </b>(indexed text)<b> in </b>(indexed text)<b> with </b>(indexed text)<b></b><table CELLPADDING=0 CELLSPACING=0 width='100%'><tr><td halign='left' valign='center' CELLPADDING=0 CELLSPACING=0><font>
<!-- definition of ph_replacere -->

<p>This phrase acts on the named text by matching the regular expression and replacing anything which fits it, as many non-overlapping times as possible. Example:
<p>
<blockquote><font color="#000080">replace the regular expression &quot;\d+&quot; in V with &quot;...&quot;
</font></blockquote><p>
<p>
<p>changes &quot;The Battle of Waterloo, 1815, rivalled Trafalgar, 1805&quot; to &quot;The Battle of Waterloo, ..., rivalled Trafalgar, ...&quot;. The &quot;case insensitively&quot; causes lower and upper case letters to be treated as if the same letter.
<p>
<p>When replacing a regular expression, the replacement text also has a few special meanings (though, thankfully, many fewer than for the expression itself). Once again &quot;\n&quot; and &quot;\t&quot; can be used for line break and tab characters, and &quot;\\&quot; must be used for an actual backslash. But, very usefully, &quot;\1&quot; to &quot;\9&quot; expand as the contents of groups numbered 1 to 9, and &quot;\0&quot; to the exact text matched. So:
<p>
<blockquote><font color="#000080">replace the regular expression &quot;\d+&quot; in V with &quot;roughly \0&quot;
</font></blockquote><p>
<p>
<p>adds the word &quot;roughly&quot; in front of any run of digits in V, because \0 becomes in turn whichever run of digits matched. And
<p>
<blockquote><font color="#000080">replace the regular expression &quot;(\w+) (.*)&quot; in V with &quot;\2, \1&quot;
</font></blockquote><p>
<p>
<p>performs the transformation &quot;Frank Booth&quot; to &quot;Booth, Frank&quot;.
<p>
<p>Finally, prefixing the number by &quot;l&quot; or &quot;u&quot; forces the text it represents into lower or upper case, respectively. For instance:
<p>
<blockquote><font color="#000080">replace the regular expression &quot;\b(\w)(\w*)&quot; in X with &quot;\u1\l2&quot;;
</font></blockquote><p>
<p>
<p>changes the casing of X to &quot;title casing&quot;, where each individual word is capitalised. (This is a little slow on large texts, since so many matches and replacements are made: it's more efficient to use the official phrases for changing case.)
<p>
<!-- end definition -->
</table>
<p>
<p><hr><p>
<a name="e141"><a href=ex141.html#e141 STYLE="text-decoration: none">*<b>Example 408:  Fido</b></a><br>A dog the player can name and un-name at will.<p>
<a name="e195"><a href=ex195.html#e195 STYLE="text-decoration: none">*<b>Example 409:  Igpay Atinlay</b></a><br>A pig Latin filter for the player's commands.<p>
<a name="e37"><a href=ex37.html#e37 STYLE="text-decoration: none">*<b>Example 410:  Blackout</b></a><br>Filtering the names of rooms printed while in darkness.<p>
<a name="e251"><a href=ex251.html#e251 STYLE="text-decoration: none">**<b>Example 411:  Mr. Burns' Repast</b></a><br>Letting the player guess types for an unidentifiable fish.<p>
<!-- EXAMPLE START -->
<a name="e265"><a href=doc347.html#e265 STYLE="text-decoration: none">**<b><b>Example</b> 412:  Northstar</b></a><br>Making Inform understand ASK JOSH TO TAKE INVENTORY as JOSH, TAKE INVENTORY. This requires us to use a regular expression on the player's command, replacing some of the content.<p>
<table border=0 bgcolor="#f0f0f0" width=100%><tr><td><font>
<p>
<p>Most of the time, Inform understands commands to other characters when they take the form &quot;JOSH, TAKE INVENTORY&quot; or &quot;JOAN, WEAR THE ARMOR&quot;. But novice players might also try commands of the form ASK JOSH TO TAKE INVENTORY or ORDER JOAN TO WEAR THE ARMOR.
<p>
<p>The easiest way to make Inform understand such commands is to meddle directly with the player's command, changing it into the format that the game will understand, as here:
<p>
<blockquote><font color="#000080">&quot;Northstar&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">The Northstar Cafe is a room. &quot;The Northstar is crammed with its usual brunch crowd, and you were lucky to get a table at all. You are now awaiting the arrival of your ricotta pancakes.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Josh is a man in The Northstar Cafe. &quot;Josh is on his way past your table.&quot; The description of Josh is &quot;He is a waiter here, but you also know him socially, so he tends to be more chatty than the other waiters.&quot; A persuasion rule: persuasion succeeds.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">After reading a command:
<br>&nbsp;&nbsp;&nbsp;&nbsp;let N be indexed text;
<br>&nbsp;&nbsp;&nbsp;&nbsp;let N be the player's command;
<br>&nbsp;&nbsp;&nbsp;&nbsp;replace the regular expression &quot;\b(ask|tell|order) (.+?) to (.+)&quot; in N with &quot;\2, \3&quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;change the text of the player's command to N.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Test me with &quot;ask Josh to take inventory / tell Josh to take inventory / order Josh to take inventory&quot;.
</font></blockquote><p>
<p>
<p>Note that we have to copy N back explicitly to replace the player's command.
</td></tr></table><p>
<!-- EXAMPLE END -->
<a name="e69"><a href=ex69.html#e69 STYLE="text-decoration: none">***<b>Example 413:  Cave-troll</b></a><br>Determining that the command the player typed is invalid, editing it, and re-examining it to see whether it now reads correctly.<p>
<p><hr><p><a href=doc346.html STYLE="text-decoration: none">Previous</a> / <a href=doc348.html STYLE="text-decoration: none">Next</a> / <a href=index.html STYLE="text-decoration: none">Contents</a><p></font></div>
</body>
</html>
