<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Inform 7 - 25.25. The template layer</title>
</head>
<body>
<div style="line-height: 18px;">

<!-- SEARCH TITLE "The template layer" -->
<!-- SEARCH SECTION "25.25" -->
<!-- SEARCH SORT "025-025-000" -->
<font><table><tr width="100%"><td width=80 valign="top"><a href=doc441.html border=0><img border=0 src=images/Back.png border=0></a><a href=index.html border=0><img border=0 src=images/Home.png border=0></a><a href=doc443.html border=0><img border=0 src=images/Forward.png border=0></a></td><td valign="top"><b>25.25. The template layer</b></td></tr></table><p>
<p>
<p>When Go is clicked, Inform translates the I7 source text into I6 code, but the directly translated code could not survive on its own: it needs a large body of supporting code, also written in I6, to sustain it. (Just as a program like iTunes or Firefox cannot run on a bare machine, but needs an operating system already up and running to support it.) Until 2008, this supporting code was provided by the I6 library, that is, the standard distribution of useful I6 code supplied with distributions of Inform 6.
<p>
<p>However, the supporting code is now generated from a collection of about 35 &quot;segments&quot; of I6 code which together make up &quot;the template layer&quot;. The reason for the term &quot;template&quot; is that the segments are not quite directly copied into I7's output, but instead act as templates from which I7 generates code - the final output contains variations according to what the original source text needs. (For instance, if the original source text never uses indexed text, lists or stored actions, then the code and arrays needed to maintain the memory heap are omitted, making for a smaller final story file which will run in smaller interpreters.)
<p>
<p>Each segment has its own name, which looks like a leafname plus the &quot;.i6t&quot; filename extension (which stands for &quot;I6 template&quot;). Internally, a segment is itself divided up into named parts. For instance, the segment &quot;Relations.i6t&quot; contains a part called &quot;Symmetric One To One Relations&quot; which provides I6 routines for changing and testing such relations. There are more than 600 named parts across the template as a whole; it is quite a large program. An annotated, typeset version of the template - amounting to a roughly 500-page book - is available for download from the Inform website.
<p>
<p>The most powerful use of &quot;Include&quot; allows code to included before, instead of or after any named part or segment in the template. For example:
<p>
<blockquote><font color="#000080">Include (- ... -) before &quot;Relations.i6t&quot;.
<br>Include (- ... -) instead of &quot;Relations.i6t&quot;.
<br>Include (- ... -) after &quot;Symmetric One To One Relations&quot; in &quot;Relations.i6t&quot;.
</font></blockquote><p>
<p>
<p>Multiple such inclusions can be made for the same segment or part. If so, all will take effect in the case of &quot;before&quot; or &quot;after&quot;, but for &quot;instead of&quot; only the most recent one takes effect. Inclusions requested before, or after, a segment or part which has been replaced with &quot;instead of&quot; will take effect and appear before or after the code which appears instead of it.
<p>
<p>The pre-2008 syntax
<p>
<blockquote><font color="#000080">Include (- ... -) before the library.
</font></blockquote><p>
<p>
<p>has been withdrawn; the new syntax
<p>
<blockquote><font color="#000080">Include (- ... -) after &quot;Definitions.i6t&quot;.
</font></blockquote><p>
<p>
<p>should have the same effect.
<p>
<p>Template files are not written in literal I6, but in a marked-up, annotated form of I6 which has special transcription commands embedded into it. These commands should absolutely not be used except in the built-in template files, with one exception:
<p>
<blockquote><font color="#000080">{-segment:Flowers.i6t}
</font></blockquote><p>
<p>
<p>places the whole of the template file &quot;Flowers.i6t&quot; in this position. The built-in template does not of course contain &quot;Flowers.i6t&quot;, but Inform allows the optional &quot;I6T&quot; subfolder of the &quot;Materials&quot; folder of a project to hold additional or replacement template files. Thus the project &quot;Botanic Gardens.inform&quot; might store:
<p>
<blockquote><font color="#000080">Botanic Gardens Materials/I6T/Flowers.i6t
</font></blockquote><p>
<p>
<p>It could even contain:
<p>
<blockquote><font color="#000080">Botanic Gardens Materials/I6T/Relations.i6t
</font></blockquote><p>
<p>
<p>in which case this would automatically be used instead of the built-in copy of &quot;Relations.i6t&quot;, without any change to the I7 source text being needed. In this way, projects can (if they need to) use partly or entirely customised templates.
<p>
<p>One application of this might allow for chunks of I6 code generated by external utilities - Perl scripts, lex and yacc, or other code generators - by compiling those to suitable template files in Materials/I6T and then using an inclusion like
<p>
<blockquote><font color="#000080">Include (- {-segment:MyStuff.i6t} -).
</font></blockquote><p>
<p>
<p>in the I7 source text.
<p>
<p>Template hacking, as it's called, is a last resort. If there is any way to achieve the same ends by writing ordinary I7 source text, then that will always be better. If it is possible to write &quot;Include (- ... -)&quot; without mentioning any segment or part, that's much to be preferred, because it has more chance of continuing to work into the future when the template might have been rewritten.
<p>
<p><hr><p><a href=doc441.html STYLE="text-decoration: none">Previous</a> / <a href=doc443.html STYLE="text-decoration: none">Next</a> / <a href=index.html STYLE="text-decoration: none">Contents</a><p></font></div>
</body>
</html>
